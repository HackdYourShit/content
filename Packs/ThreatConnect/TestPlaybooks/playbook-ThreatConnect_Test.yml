id: test-ThreatConnect
inputs: []
name: test-ThreatConnect
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 502bb7d9-3032-4158-8af1-26001c5670fc
      iscommand: false
      name: ''
      version: -1
    taskid: 502bb7d9-3032-4158-8af1-26001c5670fc
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '25'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 8f63f01a-590d-4ec0-8612-7db1faed9194
      iscommand: true
      name: check owners
      script: '|||tc-owners'
      type: regular
      version: -1
    taskid: 8f63f01a-590d-4ec0-8612-7db1faed9194
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 2585\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 399ffe06-6c23-4831-8f4c-4c08292d4119
      iscommand: true
      name: Get Tags
      script: '|||tc-get-tags'
      type: regular
      version: -1
    taskid: 399ffe06-6c23-4831-8f4c-4c08292d4119
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1125,\n    \"y\": 2585\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '15'
    note: false
    scriptarguments:
      confidence:
        simple: '87'
      indicator:
        simple: 9.9.4.4
      owner: {}
      rating:
        simple: '2'
    separatecontext: false
    task:
      brand: ''
      description: Adds a new indicator to ThreatConnect.
      id: 931b6bac-2fe2-460d-8268-e7273810acb0
      iscommand: true
      name: Create Indicator
      script: '|||tc-add-indicator'
      type: regular
      version: -1
    taskid: 931b6bac-2fe2-460d-8268-e7273810acb0
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 515\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
      - '13'
      - '27'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      id: 118834d6-7096-4f1e-8c9c-622d2106cfc8
      iscommand: false
      name: Start Clean
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 118834d6-7096-4f1e-8c9c-622d2106cfc8
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 195\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
      - '29'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: d6f29135-72da-4260-8943-4371cb0869aa
      iscommand: false
      name: Main Test - indicators
      type: title
      version: -1
    taskid: d6f29135-72da-4260-8943-4371cb0869aa
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 370\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      description: {}
      eventDate: {}
      incidentName:
        simple: NewIncident
      owner: {}
      securityLabel: {}
      tag: {}
    separatecontext: false
    task:
      brand: ''
      id: a5eeb2a9-9d46-4b92-8aca-a4082563721e
      iscommand: true
      name: Create Incident
      script: '|||tc-create-incident'
      type: regular
      version: -1
    taskid: a5eeb2a9-9d46-4b92-8aca-a4082563721e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1215\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    scriptarguments:
      confidence:
        simple: '10'
      dnsActive: {}
      falsePositive: {}
      indicator:
        simple: 9.9.4.4
      observations:
        simple: '12'
      rating:
        simple: '0'
      securityLabel:
        simple: TLP:GREEN
      size: {}
      threatAssessConfidence: {}
      threatAssessRating: {}
      updatedValues: {}
      whoisActive: {}
    separatecontext: false
    task:
      brand: ''
      id: e9e6bbb5-cd87-45a8-82fe-c6ef03833b78
      iscommand: true
      name: Update Indicator (1)
      script: '|||tc-update-indicator'
      type: regular
      version: -1
    taskid: e9e6bbb5-cd87-45a8-82fe-c6ef03833b78
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 690\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    scriptarguments:
      indicator:
        simple: 9.9.4.4
      owner: {}
      tag:
        simple: Verified
    separatecontext: false
    task:
      brand: ''
      id: 191b03ee-b8b8-49c3-8cf3-50e68511c504
      iscommand: true
      name: Update Indicator (2)
      script: '|||tc-tag-indicator'
      type: regular
      version: -1
    taskid: 191b03ee-b8b8-49c3-8cf3-50e68511c504
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 865\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    scriptarguments:
      incidentId:
        simple: ${TC.Incident.ID}
      indicator:
        simple: ${TC.Indicator.Name}
      indicatorType:
        simple: ADDRESSES
      owner: {}
    separatecontext: false
    task:
      brand: ''
      id: 981dd090-6682-4e7a-8f94-9a8be04df17c
      iscommand: true
      name: Associate Indicator To Incident
      script: '|||tc-incident-associate-indicator'
      type: regular
      version: -1
    taskid: 981dd090-6682-4e7a-8f94-9a8be04df17c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1390\n  }\n}"
  '18':
    id: '18'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '21'
    note: false
    scriptarguments:
      indicator:
        simple: ${TC.Indicator.Name}
      tag:
        simple: Testing
    separatecontext: false
    task:
      brand: ''
      id: 0084218b-f6fb-46b8-810a-a37bb968d3d0
      iscommand: true
      name: Remove Indicator Tag
      script: '|||tc-delete-indicator-tag'
      type: regular
      version: -1
    taskid: 0084218b-f6fb-46b8-810a-a37bb968d3d0
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1565\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    scriptarguments:
      indicator:
        simple: ${TC.Indicator.Name}
      owner: {}
      tag:
        simple: Testing
    separatecontext: false
    task:
      brand: ''
      id: 1b13250d-daf9-4365-8789-5e69fce9b422
      iscommand: true
      name: Add temp Tag
      script: '|||tc-tag-indicator'
      type: regular
      version: -1
    taskid: 1b13250d-daf9-4365-8789-5e69fce9b422
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1040\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '5'
      - '6'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: 'Create new:

        * event

        * campaign

        * threat'
      id: d60ce9da-d2f5-4d08-80de-b8f8277309f7
      iscommand: false
      name: Group Creations
      type: title
      version: -1
    taskid: d60ce9da-d2f5-4d08-80de-b8f8277309f7
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 370\n  }\n}"
  '20':
    id: '20'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '23'
    note: false
    scriptarguments:
      indicator:
        simple: 9.9.4.4
    separatecontext: false
    task:
      brand: ''
      id: 718d86af-7b87-4b4a-812d-04426bc7c03d
      iscommand: true
      name: Delete Test Indicator
      script: '|||tc-delete-indicator'
      type: regular
      version: -1
    taskid: 718d86af-7b87-4b4a-812d-04426bc7c03d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1915\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    scriptarguments:
      confidenceThreshold: {}
      indicator:
        simple: 9.9.4.4
      ratingThreshold: {}
    separatecontext: false
    task:
      brand: ''
      id: e884fd12-498d-4ff0-8cd7-9ceb1c648c83
      iscommand: true
      name: Get Indicator
      script: '|||tc-get-indicator'
      type: regular
      version: -1
    taskid: e884fd12-498d-4ff0-8cd7-9ceb1c648c83
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1740\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    note: false
    scriptarguments:
      incidentId: {}
      incidentName: {}
      owner: {}
    separatecontext: false
    task:
      brand: ''
      id: dc23e096-149b-47b8-87e4-880c8b4943fa
      iscommand: true
      name: Fetch Incidents
      script: '|||tc-fetch-incidents'
      type: regular
      version: -1
    taskid: dc23e096-149b-47b8-87e4-880c8b4943fa
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1555,\n    \"y\": 2585\n  }\n}"
  '23':
    id: '23'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '26'
    note: false
    scriptarguments:
      incidentId:
        simple: ${TC.Incident.ID}
      owner: {}
    separatecontext: false
    task:
      brand: ''
      id: 8406fb9d-b00d-45b6-8cd8-da1b09d7daeb
      iscommand: true
      name: Get Indicators of Incident
      script: '|||tc-get-incident-associate-indicators'
      type: regular
      version: -1
    taskid: 8406fb9d-b00d-45b6-8cd8-da1b09d7daeb
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 2090\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    note: false
    scriptarguments:
      tag:
        simple: Verified
    separatecontext: false
    task:
      brand: ''
      id: 6a06a559-05ca-45d6-8596-ee6f0f98399a
      iscommand: true
      name: Get Indicators with Tag
      script: '|||tc-get-indicators-by-tag'
      type: regular
      version: -1
    taskid: 6a06a559-05ca-45d6-8596-ee6f0f98399a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1125,\n    \"y\": 2760\n  }\n}"
  '25':
    id: '25'
    ignoreworker: false
    note: false
    scriptarguments:
      limit:
        simple: '3'
      owner: {}
    separatecontext: false
    task:
      brand: ''
      id: a9b51018-6ba0-4c6b-8fe5-776b80961197
      iscommand: true
      name: Get Indicators with limit
      script: '|||tc-indicators'
      type: regular
      version: -1
    taskid: a9b51018-6ba0-4c6b-8fe5-776b80961197
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 2760\n  }\n}"
  '26':
    id: '26'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    scriptarguments:
      groupID:
        simple: ${TC.Incident.ID}
      type:
        simple: Incidents
    separatecontext: false
    task:
      brand: ''
      id: 67a3735a-633f-4839-813d-be385ee4c909
      iscommand: true
      name: Delete Incident
      script: '|||tc-delete-group'
      type: regular
      version: -1
    taskid: 67a3735a-633f-4839-813d-be385ee4c909
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 2265\n  }\n}"
  '27':
    id: '27'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '28'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: ae67bc25-2e5a-4013-8d01-a3fbdcc564e7
      iscommand: false
      name: Group Actions
      type: title
      version: -1
    taskid: ae67bc25-2e5a-4013-8d01-a3fbdcc564e7
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": -930,\n    \"y\": 360\n  }\n}"
  '28':
    id: '28'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '30'
      - '40'
    note: false
    scriptarguments:
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: Returns all groups by group type.
      id: 7da46a46-bf6b-41c7-8f3d-f90c1a234be5
      iscommand: true
      name: Get Groups
      script: '|||tc-get-groups'
      type: regular
      version: -1
    taskid: 7da46a46-bf6b-41c7-8f3d-f90c1a234be5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -930,\n    \"y\": 495\n  }\n}"
  '29':
    id: '29'
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ''
      description: Returns all indicator types available on your instance of ThreatConnect.
      id: dc841e39-37d7-46c1-83d0-5579155e7fa9
      iscommand: true
      name: Get Indicator types
      script: '|||tc-get-indicator-types'
      type: regular
      version: -1
    taskid: dc841e39-37d7-46c1-83d0-5579155e7fa9
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1830,\n    \"y\": 515\n  }\n}"
  '30':
    id: '30'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '31'
      - '33'
      - '32'
      - '34'
      - '43'
    note: false
    scriptarguments:
      description: {}
      eventDate: {}
      name:
        simple: MyTest
      owner: {}
      status: {}
      tag: {}
    separatecontext: false
    task:
      brand: ''
      description: Creates a ThreatConnect group from type Event.
      id: 065c9f67-3ba7-4df9-8ead-42211174824e
      iscommand: true
      name: Create Event Group
      script: '|||tc-create-event'
      type: regular
      version: -1
    taskid: 065c9f67-3ba7-4df9-8ead-42211174824e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -930,\n    \"y\": 700\n  }\n}"
  '31':
    id: '31'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '39'
    note: false
    scriptarguments:
      attribute_type:
        simple: External ID
      attribute_value:
        simple: '123456789'
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: Adds an attribute to a specific group.
      id: 25c405d1-a2fe-4c5b-8787-03f990a5aa5d
      iscommand: true
      name: Associate Group Attribute
      script: '|||tc-add-group-attribute'
      type: regular
      version: -1
    taskid: 25c405d1-a2fe-4c5b-8787-03f990a5aa5d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -1610,\n    \"y\": 900\n  }\n}"
  '32':
    id: '32'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '45'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
      security_label_name:
        simple: TLP:GREEN
    separatecontext: false
    task:
      brand: ''
      description: Add security label to a specific group
      id: 089184e3-e67f-4f0a-82f9-b493b500e457
      iscommand: true
      name: Add Security Label
      script: '|||tc-add-group-security-label'
      type: regular
      version: -1
    taskid: 089184e3-e67f-4f0a-82f9-b493b500e457
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -710,\n    \"y\": 900\n  }\n}"
  '33':
    id: '33'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '41'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
      tag_name:
        simple: testing
    separatecontext: false
    task:
      brand: ''
      description: Add tags to specific group
      id: bbec9dc1-eb9a-44a3-8312-7270226adcca
      iscommand: true
      name: Add Group tag
      script: '|||tc-add-group-tag'
      type: regular
      version: -1
    taskid: bbec9dc1-eb9a-44a3-8312-7270226adcca
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -1150,\n    \"y\": 900\n  }\n}"
  '34':
    id: '34'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '38'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
      indicator:
        simple: a@a.co.il
      indicator_type:
        simple: emailAddresses
    separatecontext: false
    task:
      brand: ''
      description: Associate an Indicator to a Group
      id: 8f6cc708-08c0-4f95-82d8-b9f3e73177d9
      iscommand: true
      name: Associate Indicator
      script: '|||tc-group-associate-indicator'
      type: regular
      version: -1
    taskid: 8f6cc708-08c0-4f95-82d8-b9f3e73177d9
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -270,\n    \"y\": 900\n  }\n}"
  '35':
    id: '35'
    ignoreworker: false
    note: false
    scriptarguments:
      groupID:
        simple: ${TC.Event.ID}
      type:
        simple: Events
    separatecontext: false
    task:
      brand: ''
      description: Delete a Group from ThreatConnect (Incident, Event, Campaign, Threat)
      id: cdbee6a0-fe1d-41da-89bf-4c78854751c2
      iscommand: true
      name: Delete Group
      script: '|||tc-delete-group'
      type: regular
      version: -1
    taskid: cdbee6a0-fe1d-41da-89bf-4c78854751c2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -930,\n    \"y\": 1800\n  }\n}"
  '38':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: TC.Group.GroupID
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: TC.Group.Indicator
          operator: isExists
      label: 'yes'
    id: '38'
    ignoreworker: false
    nexttasks:
      'yes':
      - '42'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: fb41a848-dd78-4fff-8a57-f22cb2e76582
      iscommand: false
      name: Verify Context
      type: condition
      version: -1
    taskid: fb41a848-dd78-4fff-8a57-f22cb2e76582
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -270,\n    \"y\": 1120\n  }\n}"
  '39':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: TC.Group.ID
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: TC.Group.Type
          operator: isExists
      label: 'yes'
    id: '39'
    ignoreworker: false
    nexttasks:
      'yes':
      - '46'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 12ec7570-b4c6-4b82-8b3d-615fe675ba3a
      iscommand: false
      name: Verify Context
      type: condition
      version: -1
    taskid: 12ec7570-b4c6-4b82-8b3d-615fe675ba3a
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -1610,\n    \"y\": 1135\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
      - '10'
      - '22'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: e9ea1475-244d-491a-8475-7b43def9a9e1
      iscommand: false
      name: Fetch commands
      type: title
      version: -1
    taskid: e9ea1475-244d-491a-8475-7b43def9a9e1
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 2440\n  }\n}"
  '40':
    id: '40'
    ignoreworker: false
    note: false
    scriptarguments:
      group_id:
        simple: '5087947'
      group_type:
        simple: campaigns
    separatecontext: false
    task:
      brand: ''
      description: Retrieve a single Group
      id: 46089b14-8478-4b6d-8bc9-af4387d0f9fb
      iscommand: true
      name: Get Group
      script: '|||tc-get-group'
      type: regular
      version: -1
    taskid: 46089b14-8478-4b6d-8bc9-af4387d0f9fb
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -420,\n    \"y\": 680\n  }\n}"
  '41':
    id: '41'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '47'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: Retrieve the Tags for a Group
      id: 0fd05e1d-9881-4e17-884d-cffa271cb586
      iscommand: true
      name: Get Group Tags
      script: '|||tc-get-group-tags'
      type: regular
      version: -1
    taskid: 0fd05e1d-9881-4e17-884d-cffa271cb586
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -1150,\n    \"y\": 1135\n  }\n}"
  '42':
    id: '42'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '47'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: View Indicators associated with a given Group
      id: ddf33d38-8d34-437a-88a1-3cef568ebaf5
      iscommand: true
      name: Get group indicators
      script: '|||tc-get-group-indicators'
      type: regular
      version: -1
    taskid: ddf33d38-8d34-437a-88a1-3cef568ebaf5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -270,\n    \"y\": 1320\n  }\n}"
  '43':
    id: '43'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '44'
    note: false
    scriptarguments:
      associated_group_id:
        simple: '3594873'
      associated_group_type:
        simple: campaigns
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: Associate one Group with another.
      id: bee433b2-b08c-4083-8c33-783ba8644f07
      iscommand: true
      name: Associate Group to Group
      script: '|||tc-associate-group-to-group'
      type: regular
      version: -1
    taskid: bee433b2-b08c-4083-8c33-783ba8644f07
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -2130,\n    \"y\": 900\n  }\n}"
  '44':
    id: '44'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '47'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: View Indicators associated with a given Group
      id: 713e67e2-b1b2-466c-82b7-f902d43f7bad
      iscommand: true
      name: Get associated groups
      script: '|||tc-get-associated-groups'
      type: regular
      version: -1
    taskid: 713e67e2-b1b2-466c-82b7-f902d43f7bad
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -2130,\n    \"y\": 1135\n  }\n}"
  '45':
    id: '45'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '47'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: "Retrieve a Group\u2019s Security Labels"
      id: 1241fdaf-2e87-4503-89f3-f3ad74c8173c
      iscommand: true
      name: Get Group Security Labels
      script: '|||tc-get-group-security-labels'
      type: regular
      version: -1
    taskid: 1241fdaf-2e87-4503-89f3-f3ad74c8173c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -710,\n    \"y\": 1135\n  }\n}"
  '46':
    id: '46'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '47'
    note: false
    scriptarguments:
      group_id:
        simple: ${TC.Event.ID}
      group_type:
        simple: events
    separatecontext: false
    task:
      brand: ''
      description: "Retrieve a Group\u2019s Attributes"
      id: 08c1119f-94b5-4a80-8727-38321f379a44
      iscommand: true
      name: Get Group Attribute
      script: '|||tc-get-group-attributes'
      type: regular
      version: -1
    taskid: 08c1119f-94b5-4a80-8727-38321f379a44
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -1610,\n    \"y\": 1350\n  }\n}"
  '47':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: TC.Group.Attribute.AttributeID
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: TC.Group.SecurityLabel.Name
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: TC.Group.AssociatedGroup.GroupID
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: TC.Group.Indicator.IndicatorID
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: TC.Group.Tag.Name
          operator: isExists
      label: 'yes'
    id: '47'
    ignoreworker: false
    nexttasks:
      'yes':
      - '35'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: d5077562-4d6b-4437-893a-a2ebf0498620
      iscommand: false
      name: 'Is all tasks finished? '
      type: condition
      version: -1
    taskid: d5077562-4d6b-4437-893a-a2ebf0498620
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -930,\n    \"y\": 1595\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      description: {}
      firstSeen: {}
      name:
        simple: NewCampaign
      owner: {}
      securityLabel: {}
      tag:
        simple: New
    separatecontext: false
    task:
      brand: ''
      id: b51a4fe2-cbec-4989-89bc-de80544ea64f
      iscommand: true
      name: Create Campaign
      script: '|||tc-create-campaign'
      type: regular
      version: -1
    taskid: b51a4fe2-cbec-4989-89bc-de80544ea64f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 515\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    scriptarguments:
      name:
        simple: NewThreat
    separatecontext: false
    task:
      brand: ''
      id: 5dc0dbce-1710-499d-812d-25a1188835fa
      iscommand: true
      name: Create Threat
      script: '|||tc-create-threat'
      type: regular
      version: -1
    taskid: 5dc0dbce-1710-499d-812d-25a1188835fa
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 515\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    note: false
    scriptarguments:
      groupID:
        simple: ${TC.Threat.ID}
      type:
        simple: Threats
    separatecontext: false
    task:
      brand: ''
      id: f6cc6e15-598f-4014-8cef-a12a88ffb141
      iscommand: true
      name: Delete Threat
      script: '|||tc-delete-group'
      type: regular
      version: -1
    taskid: f6cc6e15-598f-4014-8cef-a12a88ffb141
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 690\n  }\n}"
  '8':
    id: '8'
    ignoreworker: false
    note: false
    scriptarguments:
      groupID:
        simple: ${TC.Campaign.ID}
      type:
        simple: Campaigns
    separatecontext: false
    task:
      brand: ''
      id: f0e1e590-51bc-4a01-85be-9f657462cfed
      iscommand: true
      name: Delete Campaign
      script: '|||tc-delete-group'
      type: regular
      version: -1
    taskid: f0e1e590-51bc-4a01-85be-9f657462cfed
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 690\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 2805,\n      \"width\": 4340,\n      \"x\": -2130,\n      \"y\"\
  : 50\n    }\n  }\n}"

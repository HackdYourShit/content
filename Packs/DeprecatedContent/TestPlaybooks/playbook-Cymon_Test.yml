description: ''
id: playbook-Cymon_Test
inputs: []
name: playbook-Cymon_Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    nexttasks:
      '#none#':
      - '1'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 9a1d5dd2-4234-4a44-83a6-f0699a47d6f5
      iscommand: false
      name: ''
      version: -1
    taskid: 9a1d5dd2-4234-4a44-83a6-f0699a47d6f5
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    nexttasks:
      '#none#':
      - '2'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 00ee1074-8df4-4fdf-8973-5363a5b7a3e4
      iscommand: false
      name: Test Existent IP Command
      type: title
      version: -1
    taskid: 00ee1074-8df4-4fdf-8973-5363a5b7a3e4
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 250\n  }\n}"
  '10':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: IP
          operator: isNotExists
      label: 'yes'
    id: '10'
    nexttasks:
      'yes':
      - '11'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 0949d038-b3ee-4a09-842b-ecee13e55189
      iscommand: false
      name: Verify Context is Empty
      type: condition
      version: -1
    taskid: 0949d038-b3ee-4a09-842b-ecee13e55189
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1540\n  }\n}"
  '11':
    id: '11'
    nexttasks:
      '#none#':
      - '12'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 23907805-43f6-426b-8ca5-8f8a8c8ed01f
      iscommand: false
      name: Test IP Command with full_response = true
      type: title
      version: -1
    taskid: 23907805-43f6-426b-8ca5-8f8a8c8ed01f
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1720\n  }\n}"
  '12':
    id: '12'
    nexttasks:
      '#none#':
      - '13'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 2f827ee1-6061-4861-8b7b-9e9125026df2
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 2f827ee1-6061-4861-8b7b-9e9125026df2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1860\n  }\n}"
  '13':
    id: '13'
    nexttasks:
      '#none#':
      - '16'
      - '14'
      - '15'
    note: false
    scriptarguments:
      execution-timeout:
        simple: '60'
      fullResponse:
        simple: 'true'
      ip:
        simple: 8.8.8.8
    separatecontext: false
    task:
      brand: Cymon
      description: Check IP Reputation
      id: cb6723f5-8970-4d6d-86fa-1d454a59094f
      iscommand: true
      name: ip
      script: Cymon|||ip
      type: regular
      version: -1
    taskid: cb6723f5-8970-4d6d-86fa-1d454a59094f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 2050\n  }\n}"
  '14':
    id: '14'
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: ASN, Geo.Country, Malicious.Description
      path:
        simple: IP
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: d856a0c6-1b55-43f0-8157-4464d0ef55c1
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: d856a0c6-1b55-43f0-8157-4464d0ef55c1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 10,\n    \"y\": 2230\n  }\n}"
  '15':
    id: '15'
    nexttasks:
      'yes':
      - '17'
    note: false
    scriptarguments:
      string:
        simple: ${IP.Malicious.Vendor}
      substring:
        simple: Cymon
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: b542ea3d-9b4a-4cdd-859c-20ea7b70eaac
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: b542ea3d-9b4a-4cdd-859c-20ea7b70eaac
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 890,\n    \"y\": 2230\n  }\n}"
  '16':
    id: '16'
    nexttasks:
      'yes':
      - '17'
    note: false
    scriptarguments:
      string:
        simple: ${IP.Address}
      substring:
        simple: 8.8.8.8
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: 469df6b8-412e-4c3c-8337-6d6127aa664f
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: 469df6b8-412e-4c3c-8337-6d6127aa664f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 2230\n  }\n}"
  '17':
    id: '17'
    nexttasks:
      '#none#':
      - '18'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 5d282a63-7b9b-4688-8128-48ec1ed80f0b
      iscommand: false
      name: Test IP Command with Non-Valid IP
      type: title
      version: -1
    taskid: 5d282a63-7b9b-4688-8128-48ec1ed80f0b
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 2440\n  }\n}"
  '18':
    id: '18'
    nexttasks:
      '#none#':
      - '19'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: b08bba65-5d01-4bb8-89c5-d954e8ef03f2
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: b08bba65-5d01-4bb8-89c5-d954e8ef03f2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 2580\n  }\n}"
  '19':
    continueonerror: true
    id: '19'
    nexttasks:
      '#none#':
      - '22'
    note: false
    scriptarguments:
      execution-timeout:
        simple: '60'
      fullResponse:
        simple: 'true'
      ip:
        simple: 18.8.8.8iyt
    separatecontext: false
    task:
      brand: Cymon
      description: Check IP Reputation
      id: 223e939f-9999-4b32-86a9-48e52386bb28
      iscommand: true
      name: ip
      script: Cymon|||ip
      type: regular
      version: -1
    taskid: 223e939f-9999-4b32-86a9-48e52386bb28
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 2750\n  }\n}"
  '2':
    id: '2'
    nexttasks:
      '#none#':
      - '3'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 2a4413e6-c422-42ef-8e5b-64f009657cce
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 2a4413e6-c422-42ef-8e5b-64f009657cce
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 440\n  }\n}"
  '21':
    id: '21'
    nexttasks:
      '#none#':
      - '23'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 382c8c23-fe6e-4f97-8b85-7c998c0c1e81
      iscommand: false
      name: Test Domain Command with None-Valid Domain
      type: title
      version: -1
    taskid: 382c8c23-fe6e-4f97-8b85-7c998c0c1e81
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 3110\n  }\n}"
  '22':
    id: '22'
    nexttasks:
      '#none#':
      - '21'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: e01b9048-0450-4580-800d-4c891f341235
      iscommand: false
      name: ValidateErrorExistence
      scriptName: ValidateErrorExistence
      type: regular
      version: -1
    taskid: e01b9048-0450-4580-800d-4c891f341235
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 2940\n  }\n}"
  '23':
    id: '23'
    nexttasks:
      '#none#':
      - '24'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 869243a7-de7e-434e-8880-97c6ea44d790
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 869243a7-de7e-434e-8880-97c6ea44d790
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 3250\n  }\n}"
  '24':
    id: '24'
    nexttasks:
      '#none#':
      - '25'
    note: false
    scriptarguments:
      domain:
        simple: asdfd23rf.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Cymon
      description: Retrieves a report on a given domain
      id: cb96b17f-f954-431b-89d8-0f3792f6bfea
      iscommand: true
      name: domain
      script: Cymon|||domain
      type: regular
      version: -1
    taskid: cb96b17f-f954-431b-89d8-0f3792f6bfea
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 3430\n  }\n}"
  '25':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Domain
          operator: isNotExists
      - - left:
            iscontext: true
            value:
              simple: Cymon.Domain
          operator: isNotExists
      label: 'yes'
    id: '25'
    nexttasks:
      'yes':
      - '26'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: f1cd39e0-ca4f-41d4-8c11-208c696669fa
      iscommand: false
      name: Verify Context is Empty
      type: condition
      version: -1
    taskid: f1cd39e0-ca4f-41d4-8c11-208c696669fa
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 3615\n  }\n}"
  '26':
    id: '26'
    nexttasks:
      '#none#':
      - '27'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 859644fd-8cd2-4070-88b3-72bc9856e4fb
      iscommand: false
      name: Test Domain Command with Valid Domain
      type: title
      version: -1
    taskid: 859644fd-8cd2-4070-88b3-72bc9856e4fb
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 3795\n  }\n}"
  '27':
    id: '27'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: c32d3c2d-5efa-491c-81ef-36a5b484cd1b
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: c32d3c2d-5efa-491c-81ef-36a5b484cd1b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 3930\n  }\n}"
  '28':
    id: '28'
    nexttasks:
      '#none#':
      - '30'
      - '31'
      - '32'
      - '33'
    note: false
    scriptarguments:
      domain:
        simple: google.com
      execution-timeout:
        simple: '60'
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Cymon
      description: Retrieves a report on a given domain
      id: 08853c7e-b00f-41e3-8ad3-d4cfb4a6e351
      iscommand: true
      name: domain
      script: Cymon|||domain
      type: regular
      version: -1
    taskid: 08853c7e-b00f-41e3-8ad3-d4cfb4a6e351
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 4120\n  }\n}"
  '29':
    id: '29'
    nexttasks:
      '#none#':
      - '35'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: df6497aa-f7ff-4113-85ed-818b5e8a0460
      iscommand: false
      name: Test Domain Command with full_response = true
      type: title
      version: -1
    taskid: df6497aa-f7ff-4113-85ed-818b5e8a0460
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 4520\n  }\n}"
  '3':
    id: '3'
    nexttasks:
      '#none#':
      - '4'
      - '5'
      - '7'
      - '34'
    note: false
    scriptarguments:
      execution-timeout:
        simple: '60'
      fullResponse: {}
      ip:
        simple: 8.8.8.8
    separatecontext: false
    task:
      brand: Cymon
      description: Check IP Reputation
      id: b265fc6e-844a-462c-817b-91e5bd5efc15
      iscommand: true
      name: ip
      script: Cymon|||ip
      type: regular
      version: -1
    taskid: b265fc6e-844a-462c-817b-91e5bd5efc15
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 640\n  }\n}"
  '30':
    id: '30'
    nexttasks:
      'yes':
      - '29'
    note: false
    scriptarguments:
      string:
        simple: ${Domain.Name}
      substring:
        simple: google.com
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: 531d96db-3762-4e91-8867-7e0cdc589c93
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: 531d96db-3762-4e91-8867-7e0cdc589c93
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 680,\n    \"y\": 4310\n  }\n}"
  '31':
    id: '31'
    nexttasks:
      'yes':
      - '29'
    note: false
    scriptarguments:
      string:
        simple: ${Domain.Malicious.Vendor}
      substring:
        simple: Cymon
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: 394a0ca9-7bcd-43ba-880e-04c0d8487254
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: 394a0ca9-7bcd-43ba-880e-04c0d8487254
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1160,\n    \"y\": 4310\n  }\n}"
  '32':
    id: '32'
    nexttasks:
      '#none#':
      - '29'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: "Domain.Activities.Tags, Domain.Activities.Time, Domain.Activities.Title,\
          \ Domain.Activities.Hostname, \nDomain.Activities.IP"
      path:
        simple: Cymon
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 9d21e4d5-ca0e-4803-85bd-1f3e5c8ed299
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 9d21e4d5-ca0e-4803-85bd-1f3e5c8ed299
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 210,\n    \"y\": 4310\n  }\n}"
  '33':
    id: '33'
    nexttasks:
      '#none#':
      - '29'
    note: false
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: Domain.Malicious.Description
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 236bafdb-8d17-4cdc-8aca-bb74054a526f
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 236bafdb-8d17-4cdc-8aca-bb74054a526f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -250,\n    \"y\": 4310\n  }\n}"
  '34':
    id: '34'
    nexttasks:
      '#none#':
      - '6'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: IP.Domains
      path:
        simple: Cymon
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: d83a0a79-e3a9-4157-8cba-2f2d5d9abbee
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: d83a0a79-e3a9-4157-8cba-2f2d5d9abbee
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -180,\n    \"y\": 820\n  }\n}"
  '35':
    id: '35'
    nexttasks:
      '#none#':
      - '36'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 2f652326-b0f6-46d6-897a-35b2a4dce481
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 2f652326-b0f6-46d6-897a-35b2a4dce481
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 4650\n  }\n}"
  '36':
    id: '36'
    nexttasks:
      '#none#':
      - '38'
      - '39'
      - '40'
      - '37'
    note: false
    scriptarguments:
      domain:
        simple: google.com
      execution-timeout:
        simple: '60'
      fullResponse:
        simple: 'true'
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Cymon
      description: Retrieves a report on a given domain
      id: 44e7e61d-7d64-4425-8bdb-7e7dc0c7b786
      iscommand: true
      name: domain
      script: Cymon|||domain
      type: regular
      version: -1
    taskid: 44e7e61d-7d64-4425-8bdb-7e7dc0c7b786
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 4810\n  }\n}"
  '37':
    id: '37'
    nexttasks:
      'yes':
      - '41'
    note: false
    scriptarguments:
      string:
        simple: ${Domain.Malicious.Vendor}
      substring:
        simple: Cymon
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: fd22df77-3f1f-4b07-8d4a-94fd624aba61
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: fd22df77-3f1f-4b07-8d4a-94fd624aba61
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1150,\n    \"y\": 4980\n  }\n}"
  '38':
    id: '38'
    nexttasks:
      'yes':
      - '41'
    note: false
    scriptarguments:
      string:
        simple: ${Domain.Name}
      substring:
        simple: google.com
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: a2f24ba8-4dfc-4609-85d3-a4e2e980b1c2
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: a2f24ba8-4dfc-4609-85d3-a4e2e980b1c2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 680,\n    \"y\": 4980\n  }\n}"
  '39':
    id: '39'
    nexttasks:
      '#none#':
      - '41'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: "Domain.Activities.Tags, Domain.Activities.Time, Domain.Activities.Title,\
          \ Domain.Activities.Hostname, \nDomain.Activities.IP"
      path:
        simple: Cymon
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: c4f7d873-4ae6-4628-845d-24162bc363f5
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: c4f7d873-4ae6-4628-845d-24162bc363f5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 230,\n    \"y\": 4980\n  }\n}"
  '4':
    id: '4'
    nexttasks:
      'yes':
      - '6'
    note: false
    scriptarguments:
      string:
        simple: ${IP.Address}
      substring:
        simple: 8.8.8.8
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: e380d504-92b2-4d81-860e-a192864376bb
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: e380d504-92b2-4d81-860e-a192864376bb
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1080,\n    \"y\": 820\n  }\n}"
  '40':
    id: '40'
    nexttasks:
      '#none#':
      - '41'
    note: false
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: Domain.Malicious.Description
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 23b60bfa-8cb8-4e46-8bda-356c22ca9f54
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 23b60bfa-8cb8-4e46-8bda-356c22ca9f54
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -210,\n    \"y\": 4980\n  }\n}"
  '41':
    id: '41'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 7eac3ee3-971d-436f-8e49-94965542d25b
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 7eac3ee3-971d-436f-8e49-94965542d25b
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 440,\n    \"y\": 5180\n  }\n}"
  '5':
    id: '5'
    nexttasks:
      'yes':
      - '6'
    note: false
    scriptarguments:
      string:
        simple: ${IP.Malicious.Vendor}
      substring:
        simple: Cymon
      substringSeperator: {}
    separatecontext: false
    task:
      brand: ''
      description: "Checks whether substring is within string. Returns: \nyes - string\
        \ contains substring. \nno - string does not contain substring. \nIf stringSeperator\
        \ is provided, the substring will be split using the separator, and each item\
        \ will be checked.\nIf one of the items will be found in the string, the srcipt\
        \ will return yes.\n"
      id: 67698dc7-2ea2-4b43-8c13-1fbc13f68d57
      iscommand: false
      name: StringContains
      scriptName: StringContains
      type: condition
      version: -1
    taskid: 67698dc7-2ea2-4b43-8c13-1fbc13f68d57
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 660,\n    \"y\": 820\n  }\n}"
  '6':
    id: '6'
    nexttasks:
      '#none#':
      - '8'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: ''
      id: 90d1fdcf-380c-4c7c-8131-7a4ed023ddee
      iscommand: false
      name: Test Non-Existent IP Command
      type: title
      version: -1
    taskid: 90d1fdcf-380c-4c7c-8131-7a4ed023ddee
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1020\n  }\n}"
  '7':
    id: '7'
    nexttasks:
      '#none#':
      - '6'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: ASN, Geo.Country, Malicious.Description
      path:
        simple: IP
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: f24373b9-27f0-4f90-86fd-92b259f9f108
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: f24373b9-27f0-4f90-86fd-92b259f9f108
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 240,\n    \"y\": 820\n  }\n}"
  '8':
    id: '8'
    nexttasks:
      '#none#':
      - '9'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 4e262032-04b4-4479-8e73-25855cb8a86a
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 4e262032-04b4-4479-8e73-25855cb8a86a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1180\n  }\n}"
  '9':
    id: '9'
    nexttasks:
      '#none#':
      - '10'
    note: false
    scriptarguments:
      execution-timeout:
        simple: '60'
      fullResponse: {}
      ip:
        simple: 18.8.8.8
    separatecontext: false
    task:
      brand: Cymon
      description: Check IP Reputation
      id: 4362fcf1-2965-44a3-8615-0d1f82023cac
      iscommand: true
      name: ip
      script: Cymon|||ip
      type: regular
      version: -1
    taskid: 4362fcf1-2965-44a3-8615-0d1f82023cac
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1360\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 5195,\n      \"width\": 1790,\n      \"x\": -250,\n      \"y\"\
  : 50\n    }\n  }\n}"
